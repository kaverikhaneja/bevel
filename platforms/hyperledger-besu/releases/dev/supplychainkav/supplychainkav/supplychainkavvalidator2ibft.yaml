apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainkavvalidator2ibft
  namespace: supplychainkav-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainkavvalidator2ibft
  chart:
    git: https://github.com/kaverikhaneja/blockchain-automation-framework.git
    ref: besu-privateTx
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://056160ee647319fea97b09c0b2bb04cc463630c71864740197d65510f1aaeb187044c73db406c54248db21411436f52f0550543c53e270ff96f71c8905f6edff@validator1.bes.dev2.aws.blockchaincloudpoc-develop.com:15041"
      
      - "enode://af394940cbd427e5c27bdf0b2eb7cc4171e90b0ed24fadfcaea9590052faee0458c4f60e7a3286e980b11baf5d13f20643ee42611f7e41c55af9a3acd813f6bf@validator2.bes.dev2.aws.blockchaincloudpoc-develop.com:15043"
      
      - "enode://878791c06849287777e5118cce4897a31729ea5837f82ad3cf92bd723ad96917f035476681fa30f599b496785bc4b3108abfa8ea35be73b1b2d276acc8985437@validator3.bes.dev2.aws.blockchaincloudpoc-develop.com:15045"
      
      - "enode://993fd33731c7ee30c529a7d3b31ad71609893257a91e7fc475f42dd3f2528e748cab26e68a62edd71d7abe9fdec1d6dd0e6c1f0415db16aeca2c1b56f5265aba@validator4.bes.dev2.aws.blockchaincloudpoc-develop.com:15047"
      
      - "enode://2a0c53f0eac8cdfb7733296e27f27072d65eacfd16fa353c6c2a2368600840d3fa0ded0fa2638b1fdb09aad6df9b881d2151b85e6121a9c4a857db225d98946a@peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15049"
      
      - "enode://40fd1febbf7a17d36894c85bb8edfef52d6b7150fcf03e16d32a3da7a1d4e7341911ca98ae75b7ffcdde52c6b5584513e67491b1d311c6baa59c199e7b41c1ff@peer2.bes.dev2.aws.blockchaincloudpoc-develop.com:15063"
      
      - "enode://cbc935743c749871f1a528224df2d9cc61029da8faaaa4dca42d273f5f8575d0796d3750595ca333753596574ebf7a8359935a2c4409e83b3f9809467daa15a1@peer3.bes.dev2.aws.blockchaincloudpoc-develop.com:15067"
      
      - "enode://c8be1349ccf0f36edb8eddf9d401b61d9b764a6b5be63272547fd8d228c25271bb844b06ea5ba8ba326375c935cbeb29c2a20f5d2c45f062334b0635f91d4fee@peer4.bes.dev2.aws.blockchaincloudpoc-develop.com:15001"
      

    metadata:
      namespace: supplychainkav-bes
      labels:

    ambassador:
      external_url_suffix: bes.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
 
    proxy:
      provider: ambassador
      external_url: supplychainkav.bes.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15043
      rpc: 15044

    images:
      node: hyperledger/besu:21.1.1
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator2
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://vault.internal.dev2.aws.blockchaincloudpoc-develop.com:20001
      secretprefix: secretsv2/data/supplychainkav-bes/crypto/validator2
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychainkav

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NGI4ZDBlZDBhOWViZDBjODQwYWVmMGQ3OGVlNmI2OThiMzA2ZmQ5Y2M5NDYzYmM0ZWEzZjgzMmQzYmE5ZDFjZGRjZDA3MWU5YjhmMDcyZjAxNmI5NDVkMTZmYTVhOWNkMGZjYjFjY2M5NmQ1NWZiYWUwOTgwMDQ1N2VlZGU5NDZkNzJlZDJkNjI4YzBkMDZkMmVjODM0ZGJiNjkyZjNhZDE3OGM3MmU4MDg0MDAwMDAwMDBjMCIKfQ==
