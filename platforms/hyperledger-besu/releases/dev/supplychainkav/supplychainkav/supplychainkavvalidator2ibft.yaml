apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainkavvalidator2ibft
  namespace: supplychainkav-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainkavvalidator2ibft
  chart:
    git: https://github.com/kaverikhaneja/blockchain-automation-framework.git
    ref: feature-1562
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://c5d3310d35ab34d20f2118d9ae70c06eeb3a9d4d1ad88490c003646c6b7ca2b8e5feae5c08c381c48cb90f8ef5af2b38578208133bcc52d2142dc4a783dc6f19@validator1.bes.dev2.aws.blockchaincloudpoc-develop.com:15041"
      
      - "enode://1d074978c8e18c0200040559e3bd9eb322dea437d65d3b56bc1124582549616d33ae767d1ea30e36c613df5d06c580f0dd28021b66ea0ed5d9031a570907d363@validator2.bes.dev2.aws.blockchaincloudpoc-develop.com:15043"
      
      - "enode://7098a11acf549c735b549609130e15016938dfdc43c53f4a408d917150f150d5747ebea58456bbd386fe197c24c66fe8b32e8a8223fb5d85558018022c4845e0@validator3.bes.dev2.aws.blockchaincloudpoc-develop.com:15045"
      
      - "enode://591eeaa1a07413604ef973d65a85fa14973c789ed808971b8baf3cb18d6cd8426e89571f3d66b8edbe2808ed68b4ee10317478fc9dcd41107deabe62ab0987fc@validator4.bes.dev2.aws.blockchaincloudpoc-develop.com:15047"
      
      - "enode://150d75777ec5f2b0eb644c8c4b34d8c8349b943e45091353f5c008554795bf9951bebc8b6f08cdebb4fff0eb2d7ebd67c18ee998e5f123476d81777e06adb249@c-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15049"
      
      - "enode://25c576f6396b80011299f36da75e6f461e0441b63908bc00a471b597e49b2ec48ff5d6fcfc9736d8deb3e0a91bd7d321955c11199c15b39b603bd74b7591bea9@m-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15061"
      

    metadata:
      namespace: supplychainkav-bes
      labels:

    ambassador:
      external_url_suffix: bes.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
 
    proxy:
      provider: ambassador
      external_url: supplychainkav.bes.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15043
      rpc: 15044

    images:
      node: hyperledger/besu:21.1.1
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator2
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://adf3753447cd347f4a78818d36eab86e-351981302.eu-west-1.elb.amazonaws.com:20002
      secretprefix: secretsv2/data/supplychainkav-bes/crypto/validator2
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychainkav

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NDc5OGE2ZWEyYWIxZWVmZjY4MzQwMWQ5NDE3ZDdhYjlhYTlhNzRjZmQ5NGM3MDU3NDY2ZmUxMTg0MDg1YjdkMWU4NjU2MjQ3NDAxOTk4NjRjNjg5NDhkMDY2Mzk0NDdjZmUyYWJhM2E5MDM2ZGQ4ZDUzYWNjNDBmMWUxODY5NDg3ODAxYjQ0MDc4YWYzNzIwNTdlZjYyZjQ1ZTc3YmRjODc0OTg2Yjk4MDg0MDAwMDAwMDBjMCIKfQ==
