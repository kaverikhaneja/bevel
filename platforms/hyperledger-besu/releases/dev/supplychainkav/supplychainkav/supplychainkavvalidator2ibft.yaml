apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainkavvalidator2ibft
  namespace: supplychainkav-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainkavvalidator2ibft
  chart:
    git: https://github.com/kaverikhaneja/blockchain-automation-framework.git
    ref: feature-1562
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://9f3ab3f1f3a191f6745a94e3c5c860789e5783d555cc5f2443adc0c499e672ef4a21fbb013d0cde1121ed43cc17d592e572d9818b0a067884e454299fb2fd5a0@validator1.bes.dev2.aws.blockchaincloudpoc-develop.com:15041"
      
      - "enode://55101b59673dcfa6054e018b047540ddb99e1a57263085a2ffb28e653d84317e7e31ab69428cf9fd2304054067932067881f9e47b5410b420c4c79c8bf33d50d@validator2.bes.dev2.aws.blockchaincloudpoc-develop.com:15043"
      
      - "enode://07379b325eeef06435ea71413f6480301579e4425acc1de186792bb3c52c1d5c3b0b35e717aa8ff214d852ea737d7eb2898d28a2d55781c75fddee3364eecf41@validator3.bes.dev2.aws.blockchaincloudpoc-develop.com:15045"
      
      - "enode://d7f43457cd6fa76ee5a652f63ce0ee70ad61cca0e8626f245b1401fe467a1e4c7ba13391466b8d7b2f1d10d47cb759c1f79da580b3c63083cc4c36e4ed3b1ab2@validator4.bes.dev2.aws.blockchaincloudpoc-develop.com:15047"
      
      - "enode://0df154e5358c18b61fbb4fa6dac1db6861decbe64d843a2dfe5d482345d6234c3d599ea9b6d4f4587e3b2ccaed71ccb6d8d0bdcf635bcbc1f69de6cc81b1734e@c-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15049"
      
      - "enode://3b7f9665f49e2d8973e35cf08ba7f02b6ebc77415971007eacc4e75fc6e097ead82f93a71fbe4b5d6e5a3208741dc1cd1b6d85535c33608614daec52a3a743ae@m-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15061"
      

    metadata:
      namespace: supplychainkav-bes
      labels:

    ambassador:
      external_url_suffix: bes.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
 
    proxy:
      provider: ambassador
      external_url: supplychainkav.bes.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15043
      rpc: 15044

    images:
      node: hyperledger/besu:21.1.1
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator2
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://adf3753447cd347f4a78818d36eab86e-351981302.eu-west-1.elb.amazonaws.com:20002
      secretprefix: secretsv2/data/supplychainkav-bes/crypto/validator2
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychainkav

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NDhlY2E1YjRmZDJlNGJiNTkwZDZmYjcwYmIzZGZhNjI2ZGE4MDhiNzE5NGMyNjZhYzliOWNmZjQxY2JiNGMyZjM0MmU4ZTk1MDZiNTc3MWYxNmY5NGMxMzQ2NDQyNDdiN2FiYzAwNjU2YWY0YmE1NTIyY2Q1ZmRkNDI0NTc5NDg5NGQ1ZDlkZGRjOGM4NDJkM2MwNGQ4MzZmYzQyZmUwM2RmZTMxNDA4MDg0MDAwMDAwMDBjMCIKfQ==
