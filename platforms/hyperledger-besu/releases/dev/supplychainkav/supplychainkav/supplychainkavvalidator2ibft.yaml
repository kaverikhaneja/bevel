apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainkavvalidator2ibft
  namespace: supplychainkav-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainkavvalidator2ibft
  chart:
    git: https://github.com/kaverikhaneja/blockchain-automation-framework.git
    ref: private-tx-express-app
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://eb4c4f4377f567ca0bbff4e9b39a32380c63585da60adb03b164422bf6f31dd70ae36b187e4be67044eb0893693ae70006173c0ae60ec27a991bd300606cbee4@validator1.bes.dev2.aws.blockchaincloudpoc-develop.com:15041"
      
      - "enode://988c2c4eeb4452839cfbdc51ced2efecd177c8df07bebd7562a228ef297d0d8d6c92fe7b40ed0523fe7fd9557985411f1d11f6806ae6832cde766d6430859fec@validator2.bes.dev2.aws.blockchaincloudpoc-develop.com:15043"
      
      - "enode://4fcaa74d44570c94d630c22199cececea1f58966c0cb37d9cd0f7138d58869e8a4cc29f21ef071366bf1037f28de2b350bd4eb94da5b3d8550427477f62bfb29@validator3.bes.dev2.aws.blockchaincloudpoc-develop.com:15045"
      
      - "enode://e67a8a883c8f11bce7ac3189e55c9994574cee558356c7883b5b85ec82542d96a565bfe5314f6489c77d8119d5db8fcc910e0c87d6f339f4250133fdc9a7f836@validator4.bes.dev2.aws.blockchaincloudpoc-develop.com:15047"
      
      - "enode://9ff38ed25a95eb724d59cc9799c523b2494d8311f855f5aca3ae0dcc49f81ddc55378a850baad214d26cd4551fe1e170c50d18e4a2098f0c08b2f096cc30814f@c-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15049"
      
      - "enode://b92f56dc152c126715c6bcc7e9f5f8261f538cffbe48c767faa8ffeecb6bb3510e54cc98ef34cb67e5f22e904cc08cbb0f7136b3cb175383f7c9a22309b0228b@m-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15061"
      
      - "enode://b268b3408d9c83bf0664f76d6ac21ce11fec145ab7c6fa1863959fae69bcf5a3ae7c8c41acea878ccfa0b3a6b9402204ea95a9f72dd3ad7bef50a68c119975fc@s-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15063"
      

    metadata:
      namespace: supplychainkav-bes
      labels:

    ambassador:
      external_url_suffix: bes.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
 
    proxy:
      provider: ambassador
      external_url: supplychainkav.bes.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15043
      rpc: 15044

    images:
      node: hyperledger/besu:21.1.1
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator2
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://vault.internal.dev2.aws.blockchaincloudpoc-develop.com:20001
      secretprefix: secretsv2/data/supplychainkav-bes/crypto/validator2
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychainkav

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NGIyZTU3NDdmMDQyOWEwZTA3ZDY0ZDYwNjI2ZDU2NGQ0NzExYTA5ZjY5NDliYmZhOWFjZWU3Mzk1ZWE2ZjFmYmIwNGJiNzdiOTVhNjI0N2RkZDY5NDQ4ODNiOGIzNDBhMTU0MWU5MmI2OWEyOTNiN2Q5NTQ4MWRiY2Y4NGM5NDA0NGVlMDM3ZTBmNWNhZWEzOGJlNzkyMWEzOThjYjMxZWE0ZDVhNDc4MDg0MDAwMDAwMDBjMCIKfQ==
