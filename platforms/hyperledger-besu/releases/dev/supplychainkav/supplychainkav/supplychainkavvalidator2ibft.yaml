apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainkavvalidator2ibft
  namespace: supplychainkav-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainkavvalidator2ibft
  chart:
    git: https://github.com/kaverikhaneja/blockchain-automation-framework.git
    ref: besu-privateTx
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://0791a2fb8aa1fa2f16ac25f610318199c748a3602691e4569eb094e09858d285977db26357a7864dc4606cbed28cf0bb5c6b6f1344ee80ea2e8188be6bd8804f@validator1.bes.dev2.aws.blockchaincloudpoc-develop.com:15041"
      
      - "enode://f0085157027d6fe1e3da9e6a9cf12ac0a2c5902d03999a877be9465a3de1ed5510ba2fb08dd96629548808eb3788d6a3d1e2ba0ba8e8cb553e822a563827be87@validator2.bes.dev2.aws.blockchaincloudpoc-develop.com:15043"
      
      - "enode://29b8463ea8aa6ae82a56190415918782f194e3dfc9b7658e226ba98bde145d4448b2e5c859571ebf5132af861e8ad6580fecc7910c91159db4bb1a525694520b@validator3.bes.dev2.aws.blockchaincloudpoc-develop.com:15045"
      
      - "enode://ff2c358a4bea92cac27cfb1c13bfde31332f11b3ef1c99eb08dec27d41245c61293b3f95c0c579813b8e4d5383585e565416a82b4454663d06056c5f89c5bb7d@validator4.bes.dev2.aws.blockchaincloudpoc-develop.com:15047"
      
      - "enode://99662ac410b33f3ff15a7af449203fd0851f35964f908b589b1c92d2de424ce7b9c31432ff77190ae74359983fd16cd3ce82a6e80052cbb187cd1f15d5efa753@c-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15049"
      
      - "enode://ebe02256c627270f4d59df2cac78af86cab37830b85e54f9e60673e5586860495e64aaf5d34acb04ffecd9487aecf6cb437a4b9637effcbeaa1df166eff355d7@m-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15061"
      
      - "enode://494053b2462050d04ff7755266734c88019e6efa4889f2345c02f9f40327aec19821eaa07954b989ed5997016bea4f83db29c660c4e49c0f0feda0ecb9d2558d@s-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15063"
      
      - "enode://15e9b4e563eaec9d13db5e25e64e67acbdc453d144553b88201ed55c8c1fd396b0afbd42cecbb2911ee0987bbe4b76a81dd77fb712dd662f05c965a1bb9cf6f7@w-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15065"
      

    metadata:
      namespace: supplychainkav-bes
      labels:

    ambassador:
      external_url_suffix: bes.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
 
    proxy:
      provider: ambassador
      external_url: supplychainkav.bes.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15043
      rpc: 15044

    images:
      node: hyperledger/besu:21.1.1
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator2
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://vault.internal.dev2.aws.blockchaincloudpoc-develop.com:20001
      secretprefix: secretsv2/data/supplychainkav-bes/crypto/validator2
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychainkav

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NDM0MmEzY2MzMWI3ZmI0M2RkMWVhODY3ZjY1OTcyOWJkYmI4NDRjYjc5NGViODBjM2RmNzgwNDk4ZDUxNTI3ZDA4M2U0MTkxZmVhNjFiYjUwNWQ5NDExMmZhOTQ4ZGJkZmExMjY3OWMxMWM2Y2MxZTljNmYzZTgxMDg2YTg5NDJmMjA3MzE4YWFlNzU1NTM2Mjc1MjgyOWM1MTk5OGQwMzk4MjBiYTE4MDg0MDAwMDAwMDBjMCIKfQ==
