apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainkavvalidator2ibft
  namespace: supplychainkav-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainkavvalidator2ibft
  chart:
    git: https://github.com/kaverikhaneja/blockchain-automation-framework.git
    ref: feature-1562
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://53001eaf73726749512f4b0c5ad61cb1406725962d2bcc2abd90ed7169222d6aee89031acb31212a3eeb4d0565af679dfef9c3694048c60ae78f2c6f94f18b4f@validator1.bes.dev2.aws.blockchaincloudpoc-develop.com:15041"
      
      - "enode://253962d53d70c35ec46d6eec7f53c3163028f8ed4f0f5505a57beca00ee9d07f9ededf2bfb52522e1a6f14e882f12737b536b725035526c4e96df1d4533cd2cf@validator2.bes.dev2.aws.blockchaincloudpoc-develop.com:15043"
      
      - "enode://5f04fa8e753cce5385c420e6e3c78eb4d2ad28612b74fa1fc5e7c9916d62807102fb0ca10568b402429183d898bd6e001f4d77b66f58320e55ea1f9756b0f75f@validator3.bes.dev2.aws.blockchaincloudpoc-develop.com:15045"
      
      - "enode://847f247d619891943ee65e8faf76fc56a063e9f6d95f7ae11fa04d57c45db63c270749c5689af45af3e8c29a970977d376599b3a73d55f3ee3263c5f4f6f99a7@validator4.bes.dev2.aws.blockchaincloudpoc-develop.com:15047"
      
      - "enode://6703215efcdacde3c6daf9d6beff8a0a7cb74e80ff77de0ea5cfe99668b2ab16b3c8f9b6797eb93053a6b6e455bde1f3ff252796a3249029ec58d585596129e3@c-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15049"
      
      - "enode://d7ceac45d901d52315fde4263f27909c8c313f6a09d39184e359da11ed0a9695d44d3b9a4686fa696c866c2a6a59870be48dfe5a229ecd82abc06b96e7c12e97@m-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15061"
      

    metadata:
      namespace: supplychainkav-bes
      labels:

    ambassador:
      external_url_suffix: bes.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
 
    proxy:
      provider: ambassador
      external_url: supplychainkav.bes.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15043
      rpc: 15044

    images:
      node: hyperledger/besu:21.1.1
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator2
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://adf3753447cd347f4a78818d36eab86e-351981302.eu-west-1.elb.amazonaws.com:20002
      secretprefix: secretsv2/data/supplychainkav-bes/crypto/validator2
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychainkav

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NDc0ZTE3MmEyNzliNGJjZDU3OTQzN2I4ZWQwZGUxOWFmOGJkYTFhYjY5NGZjMTFiZGU4NzA2YzMxNTlmNzQzODRmYWRjNWUzOGRiMTRmZGFkMjk5NDM5ODA3MmFhZjkyNzgxODI2YTQxOTRkZGY0MDBiN2Q4ZTMyZmY4NjY5NDNmOTIxYTMxZWUwNzBkOWNiN2I2NmFiNjM4Nzk5YTc4ZjU3OWY2YmQ4MDg0MDAwMDAwMDBjMCIKfQ==
