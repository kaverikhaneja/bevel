apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainkavvalidator2ibft
  namespace: supplychainkav-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainkavvalidator2ibft
  chart:
    git: https://github.com/kaverikhaneja/blockchain-automation-framework.git
    ref: feature-1562
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://2171a31732574a772e0e3b456a2dc26ceb0a5a6bd199041a79a4eb6d4581734d7a73152df829d6e1e77ec649f0000184a7827aa51bf82d65a63d300f8bf1a2a4@validator1.bes.dev2.aws.blockchaincloudpoc-develop.com:15041"
      
      - "enode://a09a871d782b72de9917e77d9d3eeada8052193d644250bf0d4c1c1831e54f582f9e581d295c1898494678f530ddf08ee15f78edde61e71c2e1eb91d51e49a97@validator2.bes.dev2.aws.blockchaincloudpoc-develop.com:15043"
      
      - "enode://57b94b9fd0c7bf738d213591c50d179cc366189c513d6edca76c3657ff4e5515a0f940ff158b46ec07a8532c795da0699e3435f52ac7abe906394098f26138d3@validator3.bes.dev2.aws.blockchaincloudpoc-develop.com:15045"
      
      - "enode://a8bda9d7a67cf2c43a653d7ed7b4cca2f170802b5aa851a8a2d32a50515f2907891daa83dfbec3cbb0e0c0358974d24880432fe0e5d93216451b5666f23ee249@validator4.bes.dev2.aws.blockchaincloudpoc-develop.com:15047"
      
      - "enode://909be0cda80136ac596cbb31719d6b00c719aa451f812c12ed714619e824e96fd30cddb239ed4ea0994ed44a3b646cc0426aa3621066acd244ab3d1ea639c0cf@c-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15049"
      
      - "enode://781e224335ddaccbc7949ebff165e2b7dd09b6a53fbac7dbd8a9aa98696066ff78b4498a3f540ce4e688aafe6fb8a912c977f5c2fd77f4a333b08cd642367df2@m-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15061"
      

    metadata:
      namespace: supplychainkav-bes
      labels:

    ambassador:
      external_url_suffix: bes.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
 
    proxy:
      provider: ambassador
      external_url: supplychainkav.bes.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15043
      rpc: 15044

    images:
      node: hyperledger/besu:21.1.1
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator2
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://adf3753447cd347f4a78818d36eab86e-351981302.eu-west-1.elb.amazonaws.com:20002
      secretprefix: secretsv2/data/supplychainkav-bes/crypto/validator2
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychainkav

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NDQzMGVmZTY4ZGIzNTc1Y2U1ZmY2YTM0OTM0MGIxODY0Njc4YWI0ZDA5NDU4ZGY0NDhmNzk3NWM2ZmExMTM2NGE0MjgyMWYzNmJiNTY1ZmYzMDg5NDcxNGQzODA3NTIyNjcyZGQ2NGI0OGYxNTJkZjcyNjgzMmJjMGYxOGY5NGIxZDQwOWM1MDc5NzdiZDc3ZmIwZjg2NmQwYWRkMmE2OTFkMGM4ZGE4MDg0MDAwMDAwMDBjMCIKfQ==
