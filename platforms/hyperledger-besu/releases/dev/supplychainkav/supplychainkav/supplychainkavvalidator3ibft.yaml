apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainkavvalidator3ibft
  namespace: supplychainkav-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainkavvalidator3ibft
  chart:
    git: https://github.com/kaverikhaneja/blockchain-automation-framework.git
    ref: feature-1562
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://b278746ddabb0aecf3dca6459c928aa081dd0ea626c44df56f4d66293b1bf84c9fcc82a1938be3f396916d6c789cc259a8481010dd134b35a3683e91cc81afc6@validator1.bes.dev2.aws.blockchaincloudpoc-develop.com:15041"
      
      - "enode://bb55de90a4ac4701c01e697dfb3713b5cffc047d49d3978fd934afbd19a73360bd908b7af647eaed469f8e0aeae7ba63f1fa1d92b949d071febf02c446b7c057@validator2.bes.dev2.aws.blockchaincloudpoc-develop.com:15043"
      
      - "enode://fa8bf47f35c5a4ec646d672994001d8206b8cc1ca269433709238425d7579ac88e0dd1db528fbeecee57f8a8e8f00f3b1e49007070a6b2839472056dce9b5cc5@validator3.bes.dev2.aws.blockchaincloudpoc-develop.com:15045"
      
      - "enode://3995aac710a8dcc5a47b20eb52aeba641209bb5604ed917830e8477ca00ac6f1d7092ab1477d610c353a9139c2f8b6ee9921e73fe6274650f459362e9f6c7be1@validator4.bes.dev2.aws.blockchaincloudpoc-develop.com:15047"
      
      - "enode://7e73327d19b15e25104c6dad95b87302b78b37721103465b2ccaf5b09990b79d944286ced4efdaede6ed7f6e0c21faf0537afc0726656940f0f75bc0d66f0b20@c-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15049"
      
      - "enode://8123b621693fa3b3efde980c2c9ecc990c7009487477a099795a161ff3b5f9933fd57462dffdbad2687b2541180d1af8c29560f0dfdc0114f74f31e210b515af@m-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15061"
      

    metadata:
      namespace: supplychainkav-bes
      labels:

    ambassador:
      external_url_suffix: bes.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
 
    proxy:
      provider: ambassador
      external_url: supplychainkav.bes.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15045
      rpc: 15046

    images:
      node: hyperledger/besu:21.1.1
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator3
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://adf3753447cd347f4a78818d36eab86e-351981302.eu-west-1.elb.amazonaws.com:20002
      secretprefix: secretsv2/data/supplychainkav-bes/crypto/validator3
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychainkav

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NDFmYzRmZjNiYjMwNDVlMzlhOTM3NTY5MGJmYTg4MWYxMzMwYjk1OWE5NDI5ZmUzY2E2ZDFmZjNjNjUyYzBiZWQ5NDI5MjQyYThmODJjYTM1MTU5NDJlNDFhNzJmMmI1M2Y5ZWM0YmE1ZjViMTUzZGZiNDkzZTg3NmJkM2Y5NDg3OTlmYzkwMGJjMzg5YzIyZmRiMGQ2MmNjNzNjNjIwZGVmYTg0NzI4MDg0MDAwMDAwMDBjMCIKfQ==
