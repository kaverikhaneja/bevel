apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainkavvalidator3ibft
  namespace: supplychainkav-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainkavvalidator3ibft
  chart:
    git: https://github.com/kaverikhaneja/blockchain-automation-framework.git
    ref: private-tx-express-app
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://5807b53823c26530e6a890fbfb5743b7918cb15486824d0d0372c210d50ef3f3e263133300883724c7c2fcaf4a837271008ddd06c36291d2a3117f763eae7462@validator1.bes.dev2.aws.blockchaincloudpoc-develop.com:15041"
      
      - "enode://29879d1f050cba871c6a76fe47fdc7cc365aef8357705f227386041273e6acbb7b9c450d00371c99cf6b16c2466b155edc88507eb7c73981a89bf5480a479660@validator2.bes.dev2.aws.blockchaincloudpoc-develop.com:15043"
      
      - "enode://2f1471d711e86a73532dcf1ba7efabecd7f3f115999764f8a3083a878e7fada8ffa934fe398bedfb66549b36dd93d632cc15a9803010414fd401b03cd457095b@validator3.bes.dev2.aws.blockchaincloudpoc-develop.com:15045"
      
      - "enode://d57aad16cb9b568080aa4058e310036a51b9598ba815c6731d4cf556071055916d62ddcd6da77ec9832e82a0939b9612a29a021c5ab5deeb138b1d03819e4567@validator4.bes.dev2.aws.blockchaincloudpoc-develop.com:15047"
      
      - "enode://ae6a69c2293d819ddd6f98a41aa045b1835050767d36585676ee269a5d079ac6f1d4027c9a3b46a1bd623e47ff23ce7148954128f9f7f868bbe2ac851a1efe71@c-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15049"
      
      - "enode://7a34c398b8c40343251671f302fe086a6fcaa20526964d781d82373b94295033ee1d89fab63cf2f99ecf66b593c74e4ec3c953956dcc6cfa8d0ca3381134ce3b@m-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15061"
      

    metadata:
      namespace: supplychainkav-bes
      labels:

    ambassador:
      external_url_suffix: bes.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
 
    proxy:
      provider: ambassador
      external_url: supplychainkav.bes.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15045
      rpc: 15046

    images:
      node: hyperledger/besu:21.1.1
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator3
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://vault.internal.dev2.aws.blockchaincloudpoc-develop.com:20001
      secretprefix: secretsv2/data/supplychainkav-bes/crypto/validator3
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychainkav

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NDU3NWIxMWY0OTZmNjkyYTk3MzMzZTRiZjc1NzdhYTEwNmFjMTE0YzY5NGJlZjJmODM3OTQ0ODE0MjVkY2Y1M2RhYmIwMTY5YzM0ZGI2YTJmYjQ5NGJhODk4NDdjMzRiNjE0MjgyMTFiYmY4YzhiZWMzYTZlM2QxNzEyMGQ5NDhkYzU0ZWIzMTY4ZTk2NWY1YjQ0MTllNDQ1ZDk1ZmNmMTdmMjg1ZDI4MDg0MDAwMDAwMDBjMCIKfQ==
