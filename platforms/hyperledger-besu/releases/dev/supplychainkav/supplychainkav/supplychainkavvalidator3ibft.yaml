apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainkavvalidator3ibft
  namespace: supplychainkav-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainkavvalidator3ibft
  chart:
    git: https://github.com/kaverikhaneja/blockchain-automation-framework.git
    ref: besu-Tx
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://dfee17ca611d98788d9fe4052689b242def856d7d1b0c2dc94115fe5d7ecb07b3d5885ed39bb16ebdacfce8a7f3e1c6a748ccb01348eafc84f8bc02ed7787c1a@validator1.bes.dev2.aws.blockchaincloudpoc-develop.com:15041"
      
      - "enode://768e6a4fb644661200bb79f4a90132d4a47271cc09692932ca48f40fa50a0fd144d855d2f86d3020d40d3a7d44955e710ef8aa59331c06be82baba0288665025@validator2.bes.dev2.aws.blockchaincloudpoc-develop.com:15043"
      
      - "enode://23257a141a6a601ed832542dc4e219489b7a5a04e0ada74d8d1ca0bdb9913ea0e4babedc0eb7ae87f378e6d4a57eb222765fab63026710cda24c3eefdfb7483d@validator3.bes.dev2.aws.blockchaincloudpoc-develop.com:15045"
      
      - "enode://21b23e95380c0f53955a8e199acbe76b233c74f4dc1ed35e7ce4ea0a912b0d6424f7fbcaae08db5c3dadeed56bd856d519b4c6383f79684803bef1172902c3f2@validator4.bes.dev2.aws.blockchaincloudpoc-develop.com:15047"
      
      - "enode://5e46c1cfef6fb4cdb257d32280fe2a658dea96bb253159d3e33a2fd1d6286b1a03eaadd2ae0c193c6788786f8083decec99fa65afc2c529248405ca200a44770@c-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15049"
      
      - "enode://538754f1f0e1c345878ab591d2059041677cf73007b8edcca808a537b21c78cd182b06eae8064817ae2a7c3975b3014775faf291f985cfb022a4cdd6e3dee2c8@m-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15061"
      

    metadata:
      namespace: supplychainkav-bes
      labels:

    ambassador:
      external_url_suffix: bes.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
 
    proxy:
      provider: ambassador
      external_url: supplychainkav.bes.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15045
      rpc: 15046

    images:
      node: hyperledger/besu:21.1.1
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator3
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://vault.internal.dev2.aws.blockchaincloudpoc-develop.com:20001
      secretprefix: secretsv2/data/supplychainkav-bes/crypto/validator3
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychainkav

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NDNlZTdlZTBmMTEyMGUwMDQwZWNmMGZjMzdhMGE3ZDEwMjQ1ZmFkN2Y5NDU3MTNlNzliNjk1ZWUzZmMwYjQwMTE2MGQ2NWFkZTJiNmQ2MmFlOTY5NGY3NjA1N2NmYjYzNDdhOTdiMTI2MmZjZDJlMGIyNjZmNDRlOGJkODA5NDBiNjIyZTFkZTJlNGU0YWM2MjkwYWMzODZiYzYwYmFjODdkOThkZWU4MDg0MDAwMDAwMDBjMCIKfQ==
