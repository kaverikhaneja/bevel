apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainkavvalidator3ibft
  namespace: supplychainkav-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainkavvalidator3ibft
  chart:
    git: https://github.com/kaverikhaneja/blockchain-automation-framework.git
    ref: feature-1562
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://bffddf0f59afe404f972097a85021f5b9fd3216a2d1f815547823a171a8cb09eb6307242264f56ee62d758080a7291a56dc56c9a70089489542533876810e635@validator1.bes.dev2.aws.blockchaincloudpoc-develop.com:15041"
      
      - "enode://71d5925e5dc701b06d7723b9b89bca59cf5a4050aba372d0de173c66d6d69e60497d40f3bd50fb9b0cb0c38331221124c85b46bb1383102eee10425120391572@validator2.bes.dev2.aws.blockchaincloudpoc-develop.com:15043"
      
      - "enode://d057ba170f7cd400f9c8ab453fc83cd3162f01ba01c00438f24b32f147001d36d2c2a79700b4f499d2382da8e2f0fe8c7989f5d86c0a6d828885dcf549027783@validator3.bes.dev2.aws.blockchaincloudpoc-develop.com:15045"
      
      - "enode://322a0ba7e9fe9ebbb40ec6807e0dca0418c5303ebb34c47dd01217717330b0b2fd16a145beaaf0a36252992d6f647b1239747a8be357891d92ad4fade2398108@validator4.bes.dev2.aws.blockchaincloudpoc-develop.com:15047"
      
      - "enode://3f920cafcf0a7e1116f055f6cfb7e890934502639cd297268140031516ac2ace2b593c50ce2c9384615a7c732486924dbba163fddec4518d7f9802765193b426@c-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15049"
      
      - "enode://da17064c68d8d3de3ede6b11f644838d9f88ea8be5c6a8dd164d6d4d12f0ba824005bc34b7e0d5ee13583da8ec6e010062e99f7affa66fdbc1e2914be884b376@m-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15061"
      

    metadata:
      namespace: supplychainkav-bes
      labels:

    ambassador:
      external_url_suffix: bes.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
 
    proxy:
      provider: ambassador
      external_url: supplychainkav.bes.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15045
      rpc: 15046

    images:
      node: hyperledger/besu:21.1.1
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator3
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://adf3753447cd347f4a78818d36eab86e-351981302.eu-west-1.elb.amazonaws.com:20002
      secretprefix: secretsv2/data/supplychainkav-bes/crypto/validator3
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychainkav

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NDY4NjFmOGIxOGY3ZmFmZGQ5ZDg4M2UzMmQ2ZGYyOGI1ZmQ2NGFjZDg5NDE4NTE2ZTYwYmFhZmY3ODE4MzEwOTc5ZmUxYTRlNmRhMWRmNGU0MWM5NDY1M2JkZTkwY2UwM2Y5NTZmNDhmYmJjZmQwYTU5OTE0ZGJkMDY2Mjg5NDE0ODE5MmIyZmYwZmY5MTFkMmVlY2RmOTdhYTZhMjk3NTZmMTllNzk4MDg0MDAwMDAwMDBjMCIKfQ==
