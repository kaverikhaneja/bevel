apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainkavvalidator4ibft
  namespace: supplychainkav-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainkavvalidator4ibft
  chart:
    git: https://github.com/kaverikhaneja/blockchain-automation-framework.git
    ref: feature-1562
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://50561601fcb15918ae71cdfc6a3717004c2ad086c186439cfa56e97a20d3ff784a46b3f3b92fd97071c170420cea7eef9049e6faa4cf564fb33872857cf9968e@validator1.bes.dev2.aws.blockchaincloudpoc-develop.com:15041"
      
      - "enode://c480c98b1d7afc78d65175678046523379adc3568d8bbf6db6cb629006e78c79d598472afd7a02d000a379bad7dad1b84dce8c10f48775d7bea8ebd5346e98d3@validator2.bes.dev2.aws.blockchaincloudpoc-develop.com:15043"
      
      - "enode://57be52576cc4bde7c997d6e04877a9b6d435b87be359550ddbd3e173253f1fdecc8364d3c317d51caeb38520cec4415c73e5c30ac75cbfc55d9b8e514a8ff0ba@validator3.bes.dev2.aws.blockchaincloudpoc-develop.com:15045"
      
      - "enode://292051afae2d5a9124a1a6d401723c0d18e436ab79d4aa36cb7c0f50bc28133bc3662ea693606c8e0e25432fe73209edc683c527691c8c3733b5a9db1ddecd8a@validator4.bes.dev2.aws.blockchaincloudpoc-develop.com:15047"
      
      - "enode://0d57c456bb42b3d68fe2c0379abb411e398bfb9a81d6e52a51b07d03b54b7f326084089fdf6d8165501d11f37f4faa88945a29cd4d7ec0ba1fb03e17308731d4@c-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15049"
      
      - "enode://d05fad0a2fa2799381b0ad6706040449fe0ea8fd6ef0923037f981d62a9368b5b653ca785cced27622591010ccd1e7aaf61910a4420bab62d2f6f711d0a0bfd8@m-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15061"
      

    metadata:
      namespace: supplychainkav-bes
      labels:

    ambassador:
      external_url_suffix: bes.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
 
    proxy:
      provider: ambassador
      external_url: supplychainkav.bes.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15047
      rpc: 15048

    images:
      node: hyperledger/besu:21.1.1
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator4
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8590
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://vault.internal.dev2.aws.blockchaincloudpoc-develop.com:20001
      secretprefix: secretsv2/data/supplychainkav-bes/crypto/validator4
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychainkav

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NDE4NzQ5MDVkNWVkNzAxNGIzZWYwY2Q1YzY5Mjk5Y2I1YmZjMTA2ZWE5NDM0ZTEyN2VmMGFmNjMxOWViYTMwMzUxZjNmNDg5MTA4NzljN2M5MjI5NGU5MDJjMTY1ZWFmZWYyOWNkODFmYzAyMzQ5YjQ2MmU2Y2RjYzkxNGE5NDAwZGM3ODQ0Y2U1NGY2ZGQwMmRhM2I4NDhhODU0ZTE0ZmRjNTAxYjQ4MDg0MDAwMDAwMDBjMCIKfQ==
