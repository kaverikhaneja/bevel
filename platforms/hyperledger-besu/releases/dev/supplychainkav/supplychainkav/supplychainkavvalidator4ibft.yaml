apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainkavvalidator4ibft
  namespace: supplychainkav-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainkavvalidator4ibft
  chart:
    git: https://github.com/kaverikhaneja/blockchain-automation-framework.git
    ref: feature-1562
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://d927976277b8c9a4d37baec0a9501c8e95fa394ffe4d3c52538d1341c8c00622c738f3d482edec951f4689bcda1de0003b40c0e9114f27465ef7884dfb398f4a@validator1.bes.dev2.aws.blockchaincloudpoc-develop.com:15041"
      
      - "enode://ea29a98b6f7fab0d2337b85b2e1be3e0b500358f287bad17f3986208e8bea87a5c6bad8480358785bd37b246e5283459fcbda860e89c25d23f1ba59decedb346@validator2.bes.dev2.aws.blockchaincloudpoc-develop.com:15043"
      
      - "enode://477fdc754e88a6abdd94ddd7cd97f81df352bb4a0bef3928eaa53fbbedf17376e3e67326c33f5c7ed854897e91dd6cef28d983bcefdc718d8cd6f2a6a3009418@validator3.bes.dev2.aws.blockchaincloudpoc-develop.com:15045"
      
      - "enode://193c31f36ce9229bd5f79b1d81f9bf3d0fb19c0f785a7a2e8639d16f5d4c6f86abdee24e7578c0528852fbd453c3dd4610634b6852ab34064c27799a91ace68c@validator4.bes.dev2.aws.blockchaincloudpoc-develop.com:15047"
      
      - "enode://8af6d8d7afe7832f8ee7ee561258544b0b125d8e36c0b3acedbadbe9e9209ae02e4aa1d0f84941cbdccc49b2d59d918922785a7706ee6c7b72f6b2f0b027d53d@c-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15049"
      
      - "enode://4d8ca2f9124f2bdf65ca08f35005c8d05d08660a4b43e4b0921c1ed1d2aa5bdf8d75132d441c493bdaf2b8752d5deabd3ffce4c466945e2480b0ed4c11882e1e@m-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15061"
      

    metadata:
      namespace: supplychainkav-bes
      labels:

    ambassador:
      external_url_suffix: bes.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
 
    proxy:
      provider: ambassador
      external_url: supplychainkav.bes.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15047
      rpc: 15048

    images:
      node: hyperledger/besu:21.1.1
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator4
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://adf3753447cd347f4a78818d36eab86e-351981302.eu-west-1.elb.amazonaws.com:20002
      secretprefix: secretsv2/data/supplychainkav-bes/crypto/validator4
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychainkav

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NDUxZGNiNzcwMGIwMzI1MjZiMDc2MjM0MzA3ZjUxMDQxM2M3ZDA3YWE5NDZjZDhkZjIyN2Y5NWM5ZGZmMTg3ODRlY2NhYWQwZTQ2ZDg3OTM4NDk5NDA0OWNjNDExZDY2M2ZkYzQzOWRkMDAwZjRmZjIwOGQ0MzQwYTJiMjg5NGIwZWYxY2JlN2FlNmM1NGE3MDU0ZTg4NWUzYjE0MTZmOTRhMzI3YjM4MDg0MDAwMDAwMDBjMCIKfQ==
