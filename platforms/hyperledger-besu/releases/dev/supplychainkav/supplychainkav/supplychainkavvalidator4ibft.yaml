apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainkavvalidator4ibft
  namespace: supplychainkav-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainkavvalidator4ibft
  chart:
    git: https://github.com/kaverikhaneja/blockchain-automation-framework.git
    ref: feature-1562
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://d2111dcbe2bbb7e4cff75aae8c90b16efb64e8739b07a35bb7e77234994b978465899609c6d1d7e12a9e693d6b8670b1f44a3b7e3197282449e3dc9802d548b5@validator1.bes.dev2.aws.blockchaincloudpoc-develop.com:15041"
      
      - "enode://faf094fd7e03537e770fc7f8b1c3fc4677edc77a53c9e1d675c5d0616ad3a8f567ddba080b02f36b652208eeea3ebae0331a6c0947324aacdf77aaedc18f0f72@validator2.bes.dev2.aws.blockchaincloudpoc-develop.com:15043"
      
      - "enode://ef8ced1f58662e71bfceb33c51532ae24310a8a0802b06350820d88d405401ebced37fc0b8f87cb7235da77059ea94c864735b7b0a92a76b16d2cefe8ce9a1bd@validator3.bes.dev2.aws.blockchaincloudpoc-develop.com:15045"
      
      - "enode://9d39fd85561fdcc5821960a436d70989d85eef421db4d71b6b2f949b23c591dd1058e33dec5c1e01809684cf5aaf563ac949bc4a3256aa095bb9090ae7abcb63@validator4.bes.dev2.aws.blockchaincloudpoc-develop.com:15047"
      
      - "enode://9aab057fd9cc322af871d8812a832e90aadc66b9dace52215c02fab14aca7acba29d6ee0b8e99ed0fe6d228898410998f7e103578807b6d5a4d7353209a4a235@c-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15049"
      
      - "enode://7d28aba05b660edc093c717b4836462693783c4c01aca2b0ff2b752071dfb26824811a749b4ba7ee80f423b03c09452ccecbcc197b7065c63d3b8edcc331244b@m-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15061"
      

    metadata:
      namespace: supplychainkav-bes
      labels:

    ambassador:
      external_url_suffix: bes.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
 
    proxy:
      provider: ambassador
      external_url: supplychainkav.bes.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15047
      rpc: 15048

    images:
      node: hyperledger/besu:21.1.1
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator4
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://adf3753447cd347f4a78818d36eab86e-351981302.eu-west-1.elb.amazonaws.com:20002
      secretprefix: secretsv2/data/supplychainkav-bes/crypto/validator4
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychainkav

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NGY0M2Y0NDIwYTk0ODU0NzM4MTM5ZTg5MjM0NmRkZjA0ZTEyZDE0Nzk5NDBiNjg1Y2RmODViYzA2Y2JmOTU1NjU0ZDJiYTA0ZGY3OGQ5YWJkNGY5NGYzOWZiMGRlMzU0MWMyOGJkOTc1YzFiMjc3MWQ1MmEzNzkxYzg1MmU5NDU4ZmZmYTg3MjFiM2Y4MzRiZGY1YWQ1NTY3YzZiZTIzMTgzOTA2NjM4MDg0MDAwMDAwMDBjMCIKfQ==
