apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainkavvalidator4ibft
  namespace: supplychainkav-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainkavvalidator4ibft
  chart:
    git: https://github.com/kaverikhaneja/blockchain-automation-framework.git
    ref: besu-privateTx
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://1b0d9fa89208368e2a574e2aa8afb95709425012d6d1652c16a1fc5c93f6250b4c12a9a7163bc0a0c749fc12c05c6ea649b686c15bf1b2a69ef8502b18f5b321@validator1.bes.dev2.aws.blockchaincloudpoc-develop.com:15041"
      
      - "enode://a68025a205ea752698fde2e31c57cb3184c66a31d7cbee00d0c79c5c4f3cb07b16b6a346c48277b93b35064cb962e0d75bca5a70321149972749a21bf4c8360f@validator2.bes.dev2.aws.blockchaincloudpoc-develop.com:15043"
      
      - "enode://1851185ee4d7bed303cbadfe45a13dbae6b8786d5414ecdc959189793e5e19f341fe052a29d3730fee7e886f4e7f382b487f2125971bf72f67705b681e20ef20@validator3.bes.dev2.aws.blockchaincloudpoc-develop.com:15045"
      
      - "enode://33d3352b016eb412135cbb2ce7f676d161262a82d1a375647dc6741667d9ed4fd4d505328a96945d48afa7fc5f5be66513439e891dd6932ab994e9c58fefe742@validator4.bes.dev2.aws.blockchaincloudpoc-develop.com:15047"
      
      - "enode://1b95bb4deefcabb5558f08d12c99ca2e4d64cecd3f29fa1abc2cf8685a207e01d58957b751f437a55a0cbd4de6af35d3f76ea101f26c347f2f26a6a92309c6b5@c-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15049"
      
      - "enode://d5f9a075feba897efd5efd798075918b57a89b70983b34f92b172ffccb7cb23daba1cbea67dc91786a4b06fae20fa9ffe1914d7c8b411601f4d9107d9d4563ad@m-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15061"
      

    metadata:
      namespace: supplychainkav-bes
      labels:

    ambassador:
      external_url_suffix: bes.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
 
    proxy:
      provider: ambassador
      external_url: supplychainkav.bes.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15047
      rpc: 15048

    images:
      node: hyperledger/besu:21.1.1
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator4
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://vault.internal.dev2.aws.blockchaincloudpoc-develop.com:20001
      secretprefix: secretsv2/data/supplychainkav-bes/crypto/validator4
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychainkav

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NGYxMTY2ZTJiOTYyZWZhNWNmNDAwNzM2NTMyOGRhZTM2NzQxZTcwMzU5NGUwNDM4MDJjYzNiYTU5YzAyMWJlODRiOTRkZjczZDViNzQyYzc4MTk5NGI2NTBjNDcyOTc1NDliNDFkMGM2MjM0NzBjZTRiZjhiNTc3MTVlZjQ5NDRlZjIzMGFkOTU0YjUyNTJlOGZjY2Y1Mjk2NWY4OGM3NTg3YzJmN2E4MDg0MDAwMDAwMDBjMCIKfQ==
