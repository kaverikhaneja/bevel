apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainkavvalidator4ibft
  namespace: supplychainkav-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainkavvalidator4ibft
  chart:
    git: https://github.com/kaverikhaneja/blockchain-automation-framework.git
    ref: feature-1562
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://d7ebe541afb1ae97f196ba636e138087f245f52c9b6e27bcc27b6b85102018d28481f0e8fdd0931b2be3a691513962949633485a909a6da7019abe6123cbe568@validator1.bes.dev2.aws.blockchaincloudpoc-develop.com:15041"
      
      - "enode://5e90fe21e31772ea32d343ffbe164ff6cc933cc0b1483a415309c4258fdc1e84cae8a94656acad1be263414375096ba254f439e06a0b197682ce1bff04e182ec@validator2.bes.dev2.aws.blockchaincloudpoc-develop.com:15043"
      
      - "enode://fe9c705f201a7f85d7735813bb5bf4acfd94d7aae8be1855d2f649b29b2f5330154478c71b407d13a54173a78cab768b6cfe957938c4379adb5e219a106707d8@validator3.bes.dev2.aws.blockchaincloudpoc-develop.com:15045"
      
      - "enode://211c4e6990fcfb5375e0851bce7fef06a20466abc10ff5778b07b71cfc094765f50e8622f83ab412450ed9b32d060c36019876e6390ca3728a53a0fb5cef8cca@validator4.bes.dev2.aws.blockchaincloudpoc-develop.com:15047"
      
      - "enode://1c24c4589eff41e28bf1a54f7eb1e77a9d79fd8f9bc887a04aca87affbea1bd9ec9bf3872b9b47772acbc18b161b26b656ffa15a47b96d7649d63040bfcab44b@c-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15049"
      
      - "enode://c5b76580a24423707439111a47e0969f1ae5add9a3733377c24a1d43a44c31618da2d3ee1afc965a0a72bfbf3418af870cf0bd1a864b24a3dfbf737560ff2903@m-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15061"
      

    metadata:
      namespace: supplychainkav-bes
      labels:

    ambassador:
      external_url_suffix: bes.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
 
    proxy:
      provider: ambassador
      external_url: supplychainkav.bes.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15047
      rpc: 15048

    images:
      node: hyperledger/besu:21.1.1
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator4
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://adf3753447cd347f4a78818d36eab86e-351981302.eu-west-1.elb.amazonaws.com:20002
      secretprefix: secretsv2/data/supplychainkav-bes/crypto/validator4
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychainkav

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NGMxNGJlYTBkM2Q2OWFjMWEzNzhjZDRhMzA2ODc1OTgwMjkwODJkNDk5NGU5NTUxNTczM2FmMGVhYjMyZTgzMzlmMDNhNjAzZGNmMWZhMjc5OWU5NDgyZTZiMjQ0ODM4YTFiOGIzYTg0N2E3M2Y3M2JmZGYwYmY3ZDZkYjk5NDI2NDg0YjQ1ZjhmNDc1MDYxYmVjZDk2Njg0OWJkNGJlMzgxMDFlMjQ4MDg0MDAwMDAwMDBjMCIKfQ==
