apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainkavvalidator4ibft
  namespace: supplychainkav-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainkavvalidator4ibft
  chart:
    git: https://github.com/kaverikhaneja/blockchain-automation-framework.git
    ref: private-tx-express-app
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://2de8f8bd3c433c47959c6133b44fd08a8c416f18817a1b4e9c62a3894174aba42d05c5ce263fb7297b930adb8383cfd7fe03f39f1de3edda819ecaeacd6bc3ff@validator1.bes.dev2.aws.blockchaincloudpoc-develop.com:15041"
      
      - "enode://b3a36d84f3dbe781388094685a3056ece02b42683ad084300a4432db7c8f6f9963e0763dddc1c9d93e447dacd967f8674076a6f8d40b62264b87d3eb6f5c9525@validator2.bes.dev2.aws.blockchaincloudpoc-develop.com:15043"
      
      - "enode://a3afbca220e510f16712fd939d038ce0e2877c91e114f6c9aab28ab64985292bf3b008de055d1a959b223caa2d210ebaae4c74965f5ff4526666bddc59229fd1@validator3.bes.dev2.aws.blockchaincloudpoc-develop.com:15045"
      
      - "enode://c6680aaee9ec040729b063c29c18024e603489a4ca796132a106d6a8271b007601ad8ea9077983ab3556be9a53ed9699f1bb6e24bf39d523ec4311f47d8b3c73@validator4.bes.dev2.aws.blockchaincloudpoc-develop.com:15047"
      
      - "enode://c50ec8499205cd3e53ab3b6ac66cbbf0d9dec9e3c4119768b2bca41f2136ac0139a7acc0c394ca065a7e80ba51c6586ed8f870a7484feab57708717b1c3f6098@c-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15049"
      
      - "enode://d42932bd8744e0828ddbb2a64e929e76d90221f942d6a16b409de7b3de37e6dc74a4ce148619327f77e44b96838e0d2fd6039cc97cc4a724c33042f152da8da9@m-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15061"
      

    metadata:
      namespace: supplychainkav-bes
      labels:

    ambassador:
      external_url_suffix: bes.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
 
    proxy:
      provider: ambassador
      external_url: supplychainkav.bes.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15047
      rpc: 15048

    images:
      node: hyperledger/besu:21.1.1
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator4
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://vault.internal.dev2.aws.blockchaincloudpoc-develop.com:20001
      secretprefix: secretsv2/data/supplychainkav-bes/crypto/validator4
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychainkav

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NGJjNzgxMWRhZjZlNTMyMzBjZDAxYTQ0ZTFjNzg5ODQ5ZTRiMjcyYmQ5NDVhMmQ5ZWY1NTBhOTJiMWI3MzYzMTIzYjY1MTkxNWY4MWZhMjA5MDU5NDgzMGNiMTkxNzAzMzY4MDRlOTJkZDg3OGU0Y2M4MDRmMTVhOWJlZmY5NDVlNjQ2NDFmOWNjZGMxNDNjZDFkNDgyODJlOTFjZGM4MmNjMmUwNjM4MDg0MDAwMDAwMDBjMCIKfQ==
