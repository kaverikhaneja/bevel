apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainkavvalidator4ibft
  namespace: supplychainkav-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainkavvalidator4ibft
  chart:
    git: https://github.com/kaverikhaneja/blockchain-automation-framework.git
    ref: besu-privateTx
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://db23cbca94f2bcabf232a530a13ecf69f51f5b4bcbfd0903806e3bc1d067ef8d4644db8001a7ab856ec9c9984c8bb8460b0da9f01dadb26a0a8ecfc13c37f638@validator1.bes.dev2.aws.blockchaincloudpoc-develop.com:15041"
      
      - "enode://e6d0b2cec7b9dd3e37882f0c3e99f1adf612a6c00b86545c35882ba3820f8d5562881c1a70c17b1402f443aa89e1704766710cbe9904b8b53a3ff526328d3e68@validator2.bes.dev2.aws.blockchaincloudpoc-develop.com:15043"
      
      - "enode://a689031c62f1d397329aeaca1251f5d4c379fbd5e454daaae49a052fbfd2378377a7496e691f423279e6a9810b0a4be0c793780ade148ae9352b39902745fbb3@validator3.bes.dev2.aws.blockchaincloudpoc-develop.com:15045"
      
      - "enode://4a266b0ed706a72b14895c1ccdd3b3b01ee788edeb0b9f1e9c50d30947ec7348ac3bd3a5bb2e7c395a855bc45c77ed53d4437dd36e09da868fdd9114ef3ef246@validator4.bes.dev2.aws.blockchaincloudpoc-develop.com:15047"
      
      - "enode://fa0483592af6aaf0b3f3d1d576fc86694cfd9d7a00d4a6147044e1b02ff55914a79c52fc7c65d3623afe4235469e677400b47696a5e92702ad51716f6d2b9c5d@peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15049"
      
      - "enode://8a9c679926705fa8270e5ef930695939e666a5b480af68fdaf30165a90089e0cb0ef4fe979152f9c1bcf9c440fd3f849b5a180335a96c7ad3fae97fca84f6ee0@peer2.bes.dev2.aws.blockchaincloudpoc-develop.com:15062"
      
      - "enode://bf48d80f94d25037d592fb73d33be1aeb032c15549b052e4134526d94e0847b36104680a3c3c13e40d03406ecb43e6733494aa280dac5d994c1684d03255348e@peer3.bes.dev2.aws.blockchaincloudpoc-develop.com:15065"
      
      - "enode://e6cb75642e8ca09bf38a9d922ddf7c1f31ab19de20855d4eb187f780753f8179bb58b879b217262b967966fc067203ed6a4312eb1894b0049d66c271367af299@peer4.bes.dev2.aws.blockchaincloudpoc-develop.com:15068"
      

    metadata:
      namespace: supplychainkav-bes
      labels:

    ambassador:
      external_url_suffix: bes.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
 
    proxy:
      provider: ambassador
      external_url: supplychainkav.bes.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15047
      rpc: 15048

    images:
      node: hyperledger/besu:21.1.1
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator4
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://vault.internal.dev2.aws.blockchaincloudpoc-develop.com:20001
      secretprefix: secretsv2/data/supplychainkav-bes/crypto/validator4
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychainkav

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NGRkMWRjNGE5YTlmZmU1MjVmYzRhMGY5YmU3NmE0ZjUwYTNmMWY4Y2M5NDcyYmZlM2Y5MzczNjAzNWJhMGQ0NzBmNWI1NzAxNGEyNjZhYjk4ZTE5NGY5NTA0MjQ5Nzc3ZjgwMGU0YzhjZGM1YzJiN2Q4NDYwMTEyMTk4YWI5NGNjYTkzNDQ1NmRiYjMyYmMzMjY3OTAyNWEyNjhmYjliZGJhY2U0ZmM4MDg0MDAwMDAwMDBjMCIKfQ==
