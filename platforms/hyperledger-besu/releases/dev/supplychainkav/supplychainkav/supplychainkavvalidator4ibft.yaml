apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainkavvalidator4ibft
  namespace: supplychainkav-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainkavvalidator4ibft
  chart:
    git: https://github.com/kaverikhaneja/blockchain-automation-framework.git
    ref: feature-1562
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://f9bda7ffce4cf9ae3669f256d1a9b4787e7b2c4ce597c84e06f1dcd7c4e1d82a1fa3306963a4102d97b3f408a0c33c551c8c063b8bc9ddb34cb69052eb80b2be@validator1.bes.dev2.aws.blockchaincloudpoc-develop.com:15041"
      
      - "enode://ac38568a63d1500795de2664228c40d891a0821a58c0b6c62ea1d35c18f1c8488a6373e20cb5aa2f80bff99f0f5d095c482edefac2f037c147d0adbbf30b935b@validator2.bes.dev2.aws.blockchaincloudpoc-develop.com:15043"
      
      - "enode://5737cca527cf437ce68043ebaaf9e4362127f9719b8803870e9f95815ad45055dc8a6e2c528cf820233305f148f3ff7a9a4c5586912dedf4ce01045ea52a864c@validator3.bes.dev2.aws.blockchaincloudpoc-develop.com:15045"
      
      - "enode://e576ccb8e35d7628194889d818578ac0edd87cfb26cf9030670253979625e92ab58183287135d19bc6e10ab0ee7d18ef460e130c0a5445a733a864e7cb361407@validator4.bes.dev2.aws.blockchaincloudpoc-develop.com:15047"
      
      - "enode://93d68e747e849efd02ea302af029c7d06c062d8d1a3f0c487c0b78ab7ab70faccabdc251996e452e39baa69502ff86319112d8ccf1d16758a58991eaadc4046e@c-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15049"
      
      - "enode://02a54acfe3b572ca905e9a26c4940b5b71db8f18bbcff177794522126896ff3c823bffbd6cdee9257dcbb7f00fa0af08c744e8c03cc9a2e4c71776a011b5bd4e@m-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15061"
      

    metadata:
      namespace: supplychainkav-bes
      labels:

    ambassador:
      external_url_suffix: bes.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
 
    proxy:
      provider: ambassador
      external_url: supplychainkav.bes.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15047
      rpc: 15048

    images:
      node: hyperledger/besu:21.1.1
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator4
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://vault.internal.dev2.aws.blockchaincloudpoc-develop.com:20001
      secretprefix: secretsv2/data/supplychainkav-bes/crypto/validator4
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychainkav

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NDgzODI0ZWRiY2I3OGQ0YWE5NzU4NDNhY2JhMzRiODI1Zjg3NDA5MGM5NGU4ODQ5YTdlMDE5NTVjMTBhZGM5YTkyMWJiOTEwOTY5MTAzNDlhMjY5NDM4MGM1YmExMmQ3ODk4MjI4NDgwYTRjYjNhN2Q1ZjhlYmJiZGQ0NmQ5NGIzNWYxODkyMjYwOGEyNjYzYjJhZGU4ZTQxYTg5YTg0MjRjMGMwMDY4MDg0MDAwMDAwMDBjMCIKfQ==
