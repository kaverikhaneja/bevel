apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainkavvalidator1ibft
  namespace: supplychainkav-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainkavvalidator1ibft
  chart:
    git: https://github.com/kaverikhaneja/blockchain-automation-framework.git
    ref: feature-1562
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://4ba76dabff3a1e767ee457f5d865608e203e63a21cdfffa96d561e5027964c37e99ee5a22b9ac5c47017e19a191563d8e18e46fa687220ac3ceb60cdaa9504ba@validator1.bes.dev2.aws.blockchaincloudpoc-develop.com:15041"
      
      - "enode://65f3b7f30104254f4f21358fd482e8c15e65fafe883d6cf28383804df9c06434587de0efcee366e2b537ba1c5a76b271573ac3c6678bb8d60262e88a3d08a768@validator2.bes.dev2.aws.blockchaincloudpoc-develop.com:15043"
      
      - "enode://abb2102e7df7e76fced3cf06b552b3960beb0fef63e0e8804f21054b1aff9c863ee1da9eebd279444f9132efc30750df5363873ce74f2699ec68f425c545528c@validator3.bes.dev2.aws.blockchaincloudpoc-develop.com:15045"
      
      - "enode://45f64f6f480dc2a53b7c58ee26fec909dcd7fc280c61d1a958b0330cae627749075b66d95e1a54f9534d471d837f86455532f446034acd3f93b81e41db80b859@validator4.bes.dev2.aws.blockchaincloudpoc-develop.com:15047"
      
      - "enode://5b89837cae7cacc4b6c5400297758750dda7f0e52563ccf40ce1c548c796bde7396818a435e5bb3c4e8a9ad1d86489b83bec9d153489e61c4c04c29ab73cfe79@c-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15049"
      
      - "enode://9534c87e08f9de7e90aeb139ee5b96f4c63643b2033182b11b44b671be4c5c5a8417e158204c117d5ccefdb06211c0087d344c037481cc5354d48f892b7c2192@m-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15061"
      

    metadata:
      namespace: supplychainkav-bes
      labels:

    ambassador:
      external_url_suffix: bes.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
 
    proxy:
      provider: ambassador
      external_url: supplychainkav.bes.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15041
      rpc: 15042

    images:
      node: hyperledger/besu:21.1.1
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator1
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://vault.internal.dev2.aws.blockchaincloudpoc-develop.com:20001
      secretprefix: secretsv2/data/supplychainkav-bes/crypto/validator1
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychainkav

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NGQwOTE4YTJmMGRiZGRmNDhhZTQ3MDM0OTJiZGU2NzQ2MGY4MTdhOGY5NDI5NGJlODUxZjgzZjFiNGU0ZGY2ODczYzA3ZTIyMTRiNDNmZDk3OWQ5NGViOTQ0MzFjNjc3MmFmYTk4OThhODA4YTNjMDk2NWRkMDM5OTAwM2M5NGRjZmQ5MjhjM2QyOGMxY2ExMjA5ZmZjMjFiN2YwZmM4ZTc4OTYyOGQ4MDg0MDAwMDAwMDBjMCIKfQ==
