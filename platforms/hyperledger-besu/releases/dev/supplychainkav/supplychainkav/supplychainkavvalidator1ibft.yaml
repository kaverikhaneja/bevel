apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainkavvalidator1ibft
  namespace: supplychainkav-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainkavvalidator1ibft
  chart:
    git: https://github.com/kaverikhaneja/blockchain-automation-framework.git
    ref: feature-1562
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://c1dee492b9a896ad83e929814cc9552ef6ed470322b9cb05e9279e94c6bbc0afc056d052c135f8230434ca2c23febd93ebbdf9031caf252c4efbd4409a8265df@validator1.bes.dev2.aws.blockchaincloudpoc-develop.com:15041"
      
      - "enode://c742899b6e8bc7965453c51c97b9c81ababed0dac4ab69f8f3c6c3803edcd9b24d936dcabbf98941df923be4eaea7d6aa52263a3c0fe9cca7db2e42883c78397@validator2.bes.dev2.aws.blockchaincloudpoc-develop.com:15043"
      
      - "enode://7b7c38cfc50c873220efdd030d285230df15f736574d7da0e5670bfc2fa4a5aa7b1cea18cc7b9dbf2020fde73175f9e1ca7aa89487d5c1af368ded3957777274@validator3.bes.dev2.aws.blockchaincloudpoc-develop.com:15045"
      
      - "enode://a79707b6e6dbfe12aeffdae38ee7bdf09166aea0aa893023b91a680aaa6c64f6661caf5569a625fb9747254f4c4565decf565dc6f92f201874548cd88e0b5606@validator4.bes.dev2.aws.blockchaincloudpoc-develop.com:15047"
      
      - "enode://a7305a6c4cb32a10415459474b33e3cda5dcff43961502a0619fc17aac672513503c5e0da3b0184de76e9165465918a6ba13bbbf1d0fc3cd34e5976dd195cd70@c-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15049"
      
      - "enode://08d8a4467e74ebdc55827c60908e0b42b64d6d6dd2190e5479165ce052abf504e47e622138109469480775d505086f7bf919a9f40dcf6ecdf05e07d93d8d94c1@m-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15061"
      

    metadata:
      namespace: supplychainkav-bes
      labels:

    ambassador:
      external_url_suffix: bes.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
 
    proxy:
      provider: ambassador
      external_url: supplychainkav.bes.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15041
      rpc: 15042

    images:
      node: hyperledger/besu:21.1.1
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator1
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://vault.internal.dev2.aws.blockchaincloudpoc-develop.com:20001
      secretprefix: secretsv2/data/supplychainkav-bes/crypto/validator1
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychainkav

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NDgyNGQ2YWM5OTQ5YTJiYWI1M2M3YjQ1Y2I2YTY3M2NhNzhlNTVjZTE5NDI3NWM1ZWMwZGRhZmYyZjRmMWM4NzQ1YTNiZmZmNDM5OWRiNWRlZmU5NGQ1MjE1ZDBmZTRjZTdhMTUyMmNlNDQ2ZWU1ZTQ3ZjEwMWQwY2EzOTk5NDI3YTk3MmVmYjkyNzBiMzVjNWQ2NzczZWMwYWIzOWNiZDE2YzczMTg4MDg0MDAwMDAwMDBjMCIKfQ==
