apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainkavvalidator1ibft
  namespace: supplychainkav-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainkavvalidator1ibft
  chart:
    git: https://github.com/kaverikhaneja/blockchain-automation-framework.git
    ref: feature-1562
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://fc81819d6945869a21f0658a65409e8c2b512565032b66faa9d7c63d82cf7bd791c33e211c93c2c07b21737a45322b12519ff5a5515ec50ce8e9241198973b74@validator1.bes.dev2.aws.blockchaincloudpoc-develop.com:15041"
      
      - "enode://6636b0c411a8a4041656ce9830e5d21a0447fdfd21a6f90ca3ca8a461c3a3ce2ccb383fa2d2e7c41f1e425e3a8cbf5dacd3694fc81e7d9a98c13e022550d81de@validator2.bes.dev2.aws.blockchaincloudpoc-develop.com:15043"
      
      - "enode://6685b06b548dd95d63838c8d0c0f3f71bcfd0a67dcc0751c62385fba5d2f4c778dcdae5e4865579c3e66a2441fd8f9cb6a5c5aa82bceb8eef491cb7279474735@validator3.bes.dev2.aws.blockchaincloudpoc-develop.com:15045"
      
      - "enode://36d40b864bef3a1d73ad8b53c0b6a33d3809c2b1d68f31e8f18acd8fc4d4d12fdb80e28cf10a8292712844d720bfad1dc73697ad02f2d7d60b0d9acf66ada429@validator4.bes.dev2.aws.blockchaincloudpoc-develop.com:15047"
      
      - "enode://6c3e1f472ecf91ebb68a66710877f6ac0ba6abb0b7e88baa0ac2c761667a00e5edafa71df34dc767312e7036c026e43af10f4c4aff64536375ce474202ecd301@c-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15049"
      
      - "enode://12d36cb02b780c6cc3bc3c19c49f7a6b625eb2e5d042a96475496235f3b0cb7f3993519957514f77ce7b09f07d3560e45b075983355c75a851dd396d6ddd34b5@m-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15061"
      

    metadata:
      namespace: supplychainkav-bes
      labels:

    ambassador:
      external_url_suffix: bes.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
 
    proxy:
      provider: ambassador
      external_url: supplychainkav.bes.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15041
      rpc: 15042

    images:
      node: hyperledger/besu:21.1.1
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator1
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://adf3753447cd347f4a78818d36eab86e-351981302.eu-west-1.elb.amazonaws.com:20002
      secretprefix: secretsv2/data/supplychainkav-bes/crypto/validator1
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychainkav

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NGUxZTU0NDkzM2ZjZjM3MGVjM2EzNTQ5OTQzY2EzNzAyY2FhMWM0YmQ5NDdjNWRiYzA2NTliNjk3ZjI3NmQ2NjI2OTY2Yjc0MjY3ZDNjOWQzOTU5NGU0MDcxY2IwYmUwYTA1ZDQ0NTg3ZjYxNzQ3ZjJjYzEzYWIyMDQwY2I5NGE2M2UyZTQyZGFjNjg4ZTIyNWI1MjlkYjYzMDllNDA5ZWRmOTBhNzg4MDg0MDAwMDAwMDBjMCIKfQ==
