apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainkavvalidator1ibft
  namespace: supplychainkav-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainkavvalidator1ibft
  chart:
    git: https://github.com/kaverikhaneja/blockchain-automation-framework.git
    ref: private-tx-express-app
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://99ae6a3d9eae47f4933fef4baa522a75ad150557e58449f73835d971143ab68df21a02d7aaf3d284c9608442148330d49a7e82e2b60686499858e13980241ce9@validator1.bes.dev2.aws.blockchaincloudpoc-develop.com:15041"
      
      - "enode://758ec955555bddb242788883f620783b3c77b45b2061cede02ede03c04571551f546b23f787aaa1dae14fad96f969ff87a3341fc855437daca7229238e130c73@validator2.bes.dev2.aws.blockchaincloudpoc-develop.com:15043"
      
      - "enode://13b1c9c1d7d43675b4a1e980c95e6f809421dec645918bd0f4f0752c8b4cc4e2b038bc89a4e2d94ccf8960a6b97cad786420d9cb62a6ba61740c1afc97564caf@validator3.bes.dev2.aws.blockchaincloudpoc-develop.com:15045"
      
      - "enode://777a1e50cbb8d5da44a0eb64aefd8e51dfb7fc5dda0afae26163ad486fea1fc663f48497dbb7b0b58ff554b506a24ab367f9e9ea846b3e243049623dcf7f4d1e@validator4.bes.dev2.aws.blockchaincloudpoc-develop.com:15047"
      
      - "enode://588780d84ae04d6216881cf55cc14500580b27c3c8fb9215718d376ede06f2b3c7294e350c32537a3dea835be7c89a5ec9ac2167e90915b99f8ad6de6cbcebcd@c-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15049"
      
      - "enode://5c1a95ee50c05a74c239ee04bc4338ce00b4e4c8177756eb55709f29fcb87e72193b264af378014d6331713fbc98c473795587514ceb851405c64e7851ede906@m-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15061"
      

    metadata:
      namespace: supplychainkav-bes
      labels:

    ambassador:
      external_url_suffix: bes.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
 
    proxy:
      provider: ambassador
      external_url: supplychainkav.bes.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15041
      rpc: 15042

    images:
      node: hyperledger/besu:21.1.1
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator1
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://vault.internal.dev2.aws.blockchaincloudpoc-develop.com:20001
      secretprefix: secretsv2/data/supplychainkav-bes/crypto/validator1
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychainkav

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NDdmZTZkNjRkYzczZmI1NjZjOTY1NDNkYjE0YTE2ZDk3MWUwOWRkZDA5NGU3MTE5NjI1OTg2M2I3NTgyNmE1YzU2N2M4M2VjNDI4Y2ZlNTJkMGQ5NDAxZDI2Y2FiMDAyZTQ4MzBjNTk2MGU2MjZiMmE4OWRmNzk1OWM5MjQ5NGM3NjZmZjg0NWEyMjEyMGUwZTFkMGM3NWFiMTYzODgxODNkZmM2MDQ4MDg0MDAwMDAwMDBjMCIKfQ==
