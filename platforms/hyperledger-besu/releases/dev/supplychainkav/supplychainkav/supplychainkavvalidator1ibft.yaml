apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainkavvalidator1ibft
  namespace: supplychainkav-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainkavvalidator1ibft
  chart:
    git: https://github.com/kaverikhaneja/blockchain-automation-framework.git
    ref: besu-privateTx
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://694f2091e6261a2e2f4b15bdf5e04e9f2ddab7e30be6d7419ece69baedcf49f60bfea758ea9b51ce7162d663333a8f5eba33428fb8da25894d8ee1d993a50fce@validator1.bes.dev2.aws.blockchaincloudpoc-develop.com:15041"
      
      - "enode://27b20bb097c3fe59947ed0126614f85088962fd0f36a5a7a22db30f39a1a1bc573ad60574c0de8ae79d269cd73d6cd58434db841bae29c5a1c075cf980c8d262@validator2.bes.dev2.aws.blockchaincloudpoc-develop.com:15043"
      
      - "enode://046c2087799406a8c7a431b6ec3e3d878908999f0117da578f73158143f2ea49c0fb7886e6b044776b050c4285659f93c2fb00f315cc7bd14b17448e12608897@validator3.bes.dev2.aws.blockchaincloudpoc-develop.com:15045"
      
      - "enode://4cd0718114d814dfcd539dc59429e5d4d7a423d02d0e678e878079bb4a2c1fe07a4fe149691848441c2c80f388bde36239221369bb9097860531f4f7cf361654@validator4.bes.dev2.aws.blockchaincloudpoc-develop.com:15047"
      
      - "enode://4ec7f9c3f79f78cbca8d48956aa03fa03a04103a75a41cc123c6317bb6934bb8cd3ff43412559f9b40be2ff9ea1613951640633120dc50f380b8c5edf3091831@c-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15049"
      
      - "enode://7aff91a9a4bd86ee8d8101c457c3e96998cfef4ffbd531bc910fb79d9c108c2c47e51986ba8109ebb4f7bcc381aa0857286514d79f91ee07f62a8df04dc394ea@m-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15061"
      

    metadata:
      namespace: supplychainkav-bes
      labels:

    ambassador:
      external_url_suffix: bes.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
 
    proxy:
      provider: ambassador
      external_url: supplychainkav.bes.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15041
      rpc: 15042

    images:
      node: hyperledger/besu:21.1.1
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator1
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://vault.internal.dev2.aws.blockchaincloudpoc-develop.com:20001
      secretprefix: secretsv2/data/supplychainkav-bes/crypto/validator1
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychainkav

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NGExN2RiMmQyZjBmM2YyYWIxN2I0ZTdkNWJjOTBiYzU5ZGU0YTRlM2U5NDYxZTZiZmM0OTI1N2NmOWM5ZDAwY2U4N2Q4M2Y3ZmJiMWViNTFmZmQ5NDhhMDAxMmY3NmEzNjg2YjRhZjk4Njg1ZWQ5MGE3MGQ2MGI5ZDMwNzQ5NDk5NDcxYTE3YjE4NDhlNGM4YTJkNjQ5MTY2NDBhZjA0ZGEwNWYwNWM4MDg0MDAwMDAwMDBjMCIKfQ==
