apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainkavvalidator1ibft
  namespace: supplychainkav-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainkavvalidator1ibft
  chart:
    git: https://github.com/kaverikhaneja/blockchain-automation-framework.git
    ref: feature-1562
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://f3347d206767bdfd65a47ed952540758398ab1012ee088908d1adb42d747291e3bb2715533a598ee5d359a16ea12bfde0fdb29313210eb820608db08c841b6a1@validator1.bes.dev2.aws.blockchaincloudpoc-develop.com:15041"
      
      - "enode://4ee122825aaad5059f082271628a3a447214505be3523d230969ffdf46e284a9a0f5d6ce1b559f95d716bbed2104494cadaf03f002484379043fc4191d94e417@validator2.bes.dev2.aws.blockchaincloudpoc-develop.com:15043"
      
      - "enode://892d9eabef35b1680924272499df4c35877ca16ac47f9b4a3285af290c0b4e50898b8a27801fb7131686141dbd0152521310a2665a2fb8bd95a3cc1125199704@validator3.bes.dev2.aws.blockchaincloudpoc-develop.com:15045"
      
      - "enode://b1b169ae2ba7be6c67158b3aa356ab19ab3425ad9e721623b5a75a1aa4e33c8ae5dffa29e0f07417777828e9b4cd2b46af1dc42e6cc2508e13fe63fb4586367b@validator4.bes.dev2.aws.blockchaincloudpoc-develop.com:15047"
      
      - "enode://7416495b753e2a708b6f89e39e2723e19389ac6adeaf2ec12169811be21247cd0d73c017d4ad2aa77ff166b8de87f46a172b052e505f4bbc29afc796a191ff9b@c-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15049"
      
      - "enode://e53f87026ed82f2b2e0e5e5d02f4b279c4efae3a1ceeba72bf0e660fe16c191982f4de1ad992e54a95899eea8a42e45c06d623f2c96e9b1f7ea73884471a2be8@m-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15061"
      

    metadata:
      namespace: supplychainkav-bes
      labels:

    ambassador:
      external_url_suffix: bes.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
 
    proxy:
      provider: ambassador
      external_url: supplychainkav.bes.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15041
      rpc: 15042

    images:
      node: hyperledger/besu:21.1.1
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator1
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://vault.internal.dev2.aws.blockchaincloudpoc-develop.com:20001
      secretprefix: secretsv2/data/supplychainkav-bes/crypto/validator1
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychainkav

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NGY1ZjVkYWYxNTk0YzBmODQ2YmYzMzNhYjY2NWMxM2JmODIwMTc5YTc5NDI3NDlmOTA3OTQ5MTYwNjM2YTU0OTBmZjEyNzQ2MDk0NDA2NjdmNDY5NDFkYzNkY2RjMGM4MjFjYzRkYzc2ZWY5MzRmNDNlYzBkNWZlMDM1OTk5NDdkZTM2NTRhMWE0YTYyMzI3NjFhN2NlODc1NDQ0YzZhMWYxYTUwMGM4MDg0MDAwMDAwMDBjMCIKfQ==
