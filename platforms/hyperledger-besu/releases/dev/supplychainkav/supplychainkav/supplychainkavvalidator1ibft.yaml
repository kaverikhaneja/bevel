apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainkavvalidator1ibft
  namespace: supplychainkav-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainkavvalidator1ibft
  chart:
    git: https://github.com/kaverikhaneja/blockchain-automation-framework.git
    ref: besu-privateTx
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://c4c03b5f9ac85c298011bf68997aab8712d1add12dbf42baef669c3c76a66850addf403c7829f2c927d882902eceefe8e0b78bd4c6e14225a72b86c9ba573a63@validator1.bes.dev2.aws.blockchaincloudpoc-develop.com:15041"
      
      - "enode://3820c31658f8748472f0e0b20804a0b4ae4bbc7023819932cee4d8bb3b71ac3905dd041c5f0665be00e13d4f11556d9ce5389a9c3acf2fac724846cd1c2fa947@validator2.bes.dev2.aws.blockchaincloudpoc-develop.com:15043"
      
      - "enode://53e61712b4c4c97740537f71b8ab4a9cf782b5d86e963e33cb77e4318f6a51e3c154e8a3eaf5be1fe04a70ce7ecc2a0eb292e6f224b946051e947c4fbb5bcb82@validator3.bes.dev2.aws.blockchaincloudpoc-develop.com:15045"
      
      - "enode://63cf3c197f672b6cd02c20d22be00c923181405e45983caf28df893c60a4812aee9414e57d4594ef3fab2eae4018c2cdb281243b95b7fe8bf3a04ac880e6b4fd@validator4.bes.dev2.aws.blockchaincloudpoc-develop.com:15047"
      
      - "enode://d0c8585011539fa06a6495e952045836189ab5931c81a303d8a4f4f07c6af380c0537c1c2abab1bd4467f75a080b027e49cb6042e5fb1f9880a9ec2e936eaf9b@peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15049"
      
      - "enode://291e1768af8f0c27b502d3781afc9a8cadfc3520e81c36818771e2de515ab17eaaa807fdcf882bba7f0aca5a0a8611c1c23da328a0fde1221764be2fe04c1a1c@peer2.bes.dev2.aws.blockchaincloudpoc-develop.com:15062"
      
      - "enode://02baf94768332c4a35f74ea565b67f3d8d2de7c7ac16f41adf1d48fcc6ebe66fe0e317aa47e05925bb7e24c00ab53dd25842952b4a4d4799ea6dca245710f000@peer3.bes.dev2.aws.blockchaincloudpoc-develop.com:15065"
      
      - "enode://4fd83896e822c1688e55f562d6068f98168b876360387efd3d655dd4fabb5caa9bdf7e7f920deded32e08c8f36ef521cf5bc44a34cc1854240ee46343e21dcd4@peer4.bes.dev2.aws.blockchaincloudpoc-develop.com:15068"
      

    metadata:
      namespace: supplychainkav-bes
      labels:

    ambassador:
      external_url_suffix: bes.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
 
    proxy:
      provider: ambassador
      external_url: supplychainkav.bes.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15041
      rpc: 15042

    images:
      node: hyperledger/besu:21.1.1
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator1
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://vault.internal.dev2.aws.blockchaincloudpoc-develop.com:20001
      secretprefix: secretsv2/data/supplychainkav-bes/crypto/validator1
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychainkav

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NGI0NDRlMDQ4NTEzYmRhOWZiZjk1ZTNlOGYxNjJhMGQ4ZGU2NGM1MTA5NGE1ZTI5M2Q4OWE3ZTljZjAzNTEzOTg5YmFmYzMyODZlNjU1NjhkNGM5NGE0YjdkNWY5NzliM2RiMDNmN2IyNDYxZTM3MjA2YTYxMTE1ODNiZmI5NGE4NjJkZDM5Yjc5MzAzZjhlMmIxMDJkODViZjU4Mjc4NzJiOTMyM2U4MDg0MDAwMDAwMDBjMCIKfQ==
