apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainkavvalidator1ibft
  namespace: supplychainkav-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainkavvalidator1ibft
  chart:
    git: https://github.com/kaverikhaneja/blockchain-automation-framework.git
    ref: feature-1562
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://90627717d0dd19da87aef855a6eae41a8ecd2116eca5dca9a536158ebbf4c7c80119a5b4b0ecf1443b28dcb38498eb8a1738ee851f7eb7824b1198e290c73d84@validator1.bes.dev2.aws.blockchaincloudpoc-develop.com:15041"
      
      - "enode://e015068bf0a20a3cf9f2ead8785a7342472ee3f05342d9d23eadad207c05b866a6fdf0c358f07453a2caa043531e90ab6b5f61d78cde79663702ddf6a869460f@validator2.bes.dev2.aws.blockchaincloudpoc-develop.com:15043"
      
      - "enode://f2bc49dff597b31d8bf9ac699f4fcb8af270ed0cdc88325f5676d4785aa02346b1acfe114b1af9659ebd14262bce53962fa47ebae41e23e27719cbaaea9033de@validator3.bes.dev2.aws.blockchaincloudpoc-develop.com:15045"
      
      - "enode://207b8dd3e494a61af3e4a466204d0d479707cc7f00e22b818f9b3be6db926db22ef1b55a6412e3c2566c5cb139374b97ad88955d380df90334f7665b931ba8ca@validator4.bes.dev2.aws.blockchaincloudpoc-develop.com:15047"
      
      - "enode://63fbf937f7c8bef4b4017ac0787965327d782722bb465f8c2cbfb0eebe2e029f3ea89df9a2b5cbffe9f583db6f351ccce592412464aff9a926d196e67c79497c@c-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15049"
      
      - "enode://c196a8e5e4b136dce02a797ab44e509198148286ce70fc7155e1783f4c09f8cdda3d1fb8a9f3ff6b5f19497bd35dc066945807055c3c347f52abdcff13b80896@m-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15061"
      

    metadata:
      namespace: supplychainkav-bes
      labels:

    ambassador:
      external_url_suffix: bes.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
 
    proxy:
      provider: ambassador
      external_url: supplychainkav.bes.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15041
      rpc: 15042

    images:
      node: hyperledger/besu:21.1.1
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator1
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://vault.internal.dev2.aws.blockchaincloudpoc-develop.com:20001
      secretprefix: secretsv2/data/supplychainkav-bes/crypto/validator1
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychainkav

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NDFkNGM0ZjM4YTQ0ZDE5OGMzNTE1NWMwZjA4NGJkYjBkNDBhMjg5ZWU5NDk3N2VkNzY1YWJhMWI1MjYxOWMwYWZkYWNiMzY4ZjFmYWIxODM2NGM5NDUwYTZmM2Y5ZjY4ZmJmZThhMWI4M2NmYzlkNzdiZGJiMDA5YWYyODk5NDUwYzE5NmJiMWFlNzI1NDBmZDc5Nzk1ZDFiZjA0YmI0YjYyZWEzMDI4MDg0MDAwMDAwMDBjMCIKfQ==
