apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainkavvalidator1ibft
  namespace: supplychainkav-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainkavvalidator1ibft
  chart:
    git: https://github.com/kaverikhaneja/blockchain-automation-framework.git
    ref: besu-Tx
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://b99dcf5306829b33d8264c4b0d296a1d789eb52539c2e3c37ee719fe20b496e96a444a56ef48d325f586a1161bce46cab5468a9b7d1c90b3b5a527312730039c@validator1.bes.dev2.aws.blockchaincloudpoc-develop.com:15041"
      
      - "enode://5741eb2cc6b9d9f0d7834867bc247215811c78a4cc6cc50e186060253547c83b3a8632c40dc02596507615e43f2bf0279309663c844f4d26c9fad422bc046cb8@validator2.bes.dev2.aws.blockchaincloudpoc-develop.com:15043"
      
      - "enode://52639c9ef338f26d529a98e780dcc9add64a976be4971c403b18e032bad31e7db059ef7708061f0b638800de69c205cb33be21ab07dec5784fcc27f8249b171c@validator3.bes.dev2.aws.blockchaincloudpoc-develop.com:15045"
      
      - "enode://fab45f39fa708e6d6e0502b3af8d4b39d2e5bc559aab6ba5c4ab8383e73dd961fb085765c9a461999cf1a22f24c4c6140fccd4185dfb4b2ee791b3fa5c9c31db@validator4.bes.dev2.aws.blockchaincloudpoc-develop.com:15047"
      
      - "enode://809153512b14d77582e08a306fd4f5ce7d3a33948a8e7da14bec57f852c9d77078199fdcf447ba788c7938722fe280a661c04f27e0329dacf2876978ae0c7735@c-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15049"
      
      - "enode://2bdac8026eced2c4c04722b4a691adcc594cfceed123285625becf3d98180820c5549efe760e2167a81ed95facaf90870c70221d535ac1135a44761d647c31ad@m-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15061"
      

    metadata:
      namespace: supplychainkav-bes
      labels:

    ambassador:
      external_url_suffix: bes.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
 
    proxy:
      provider: ambassador
      external_url: supplychainkav.bes.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15041
      rpc: 15042

    images:
      node: hyperledger/besu:21.1.1
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator1
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://vault.internal.dev2.aws.blockchaincloudpoc-develop.com:20001
      secretprefix: secretsv2/data/supplychainkav-bes/crypto/validator1
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychainkav

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NGEwMzY2NzRhZTRlNzc1Y2Y4ZDUyZjE3ZDJjZDI5MWI0ZjYxYzM2OGE5NDc1NmRlZDk4M2Y0ZjljYTE4MDUzZGQ3NzJkZmNjMzRhNzhjNDVlZWY5NGJmZTYwM2VmZTk2MGVhZWVjOGZmNzMyOTE2NGEyZWI5MWNhMTVlNGI5NDk5NDkwMDczNTkwZDk4MjAxODhiMGExNTBkMDA0ZmExNzQyZDgzNTE4MDg0MDAwMDAwMDBjMCIKfQ==
