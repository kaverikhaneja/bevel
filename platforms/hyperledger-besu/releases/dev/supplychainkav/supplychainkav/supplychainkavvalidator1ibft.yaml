apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainkavvalidator1ibft
  namespace: supplychainkav-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainkavvalidator1ibft
  chart:
    git: https://github.com/kaverikhaneja/blockchain-automation-framework.git
    ref: feature-1562
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://738fd15e3a2167c66c9ac8d3a5e6c1484cf421f2c0d448f52146287264ca8941f642a28c6698b553b0cd5a34c0281f73c36c0fe80a695009d008a4b410221cbe@validator1.bes.dev2.aws.blockchaincloudpoc-develop.com:15041"
      
      - "enode://303c980deb010d5bced6d158eef9cba2fc6d860c08d25e9b3437751524553b5b5e6ebdd18b83a63f49b24bd74edb8480c727a9012eb28383898343bddfccf59b@validator2.bes.dev2.aws.blockchaincloudpoc-develop.com:15043"
      
      - "enode://8e018c9ad4818f447142d2fe4afa5af4bb309d35a89e0cb87d9b191962e910e3692ed9ecf1e5dc5e47e59d60388795b15ec6bb72ae0373a3da83889e62e11960@validator3.bes.dev2.aws.blockchaincloudpoc-develop.com:15045"
      
      - "enode://e7f7d259b3c18025177b74ed370e5c5f766f82947e90d443d7a3337d18bca4bcb68f4ec74da8b1ef50974de5a31a11306467ffc0bae8149ee0dbd4b4a91cb1b3@validator4.bes.dev2.aws.blockchaincloudpoc-develop.com:15047"
      
      - "enode://7ecbd9971749c88b2db6d65cf031718fd49d53665916e67e0aae000a3e3af6ab86ead7cdaa838758e734e0e628c20cb104806ebe610d67b6be9e0c139453839c@c-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15049"
      
      - "enode://5c88f1aa7fdfed2a15b42d4bb9ee802fca7767304cffe3894da42d2062430ee13e2d8956075a2af7a101b129694e82dd6c6b91ad6c6b710d8d67fa7a8b80593f@m-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15061"
      

    metadata:
      namespace: supplychainkav-bes
      labels:

    ambassador:
      external_url_suffix: bes.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
 
    proxy:
      provider: ambassador
      external_url: supplychainkav.bes.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15041
      rpc: 15042

    images:
      node: hyperledger/besu:21.1.1
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator1
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://vault.internal.dev2.aws.blockchaincloudpoc-develop.com:20001
      secretprefix: secretsv2/data/supplychainkav-bes/crypto/validator1
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychainkav

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NDM3ODdjNWNhNmQ5ODFhNThhZmIyNDQ2MDQzNTFkZTgzNmExODllZmU5NDdmNWEyM2U0YWJjNGVkMjU5YWU4N2M2YjA4ZmI3ODhlOGU1YTYyZGQ5NDgzMjdkYWYzMzY1ODZmYTVjMmI2OWQxOGJiNGU4ZjZiNTQ4ZmM1YmE5NDcwMWQ0MDZmZjA2YzdhZWI5YWU2Yjc0Yzk5MDUzYTZiMzA3YWIyMWI4MDg0MDAwMDAwMDBjMCIKfQ==
