apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainkavvalidator1ibft
  namespace: supplychainkav-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainkavvalidator1ibft
  chart:
    git: https://github.com/kaverikhaneja/blockchain-automation-framework.git
    ref: besu-privateTx
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://10fd5535a87647dbb6fa43d864ae2c16c6fe4a6668939b5a6f5e7f91a47e5d054bc22877aa2bd1e91c810f87cc7c9c24810ec70811aea2bdf1b1e320f8851b8d@validator1.bes.dev2.aws.blockchaincloudpoc-develop.com:15041"
      
      - "enode://b7d1f10fbf6e9928eefdc3c12fadd2af37ea81e6a2eb6a087ed720f3d17bdf0c28f9804442caf0e8e61bbd35df139c5a0d22928aa84908e77ae4ccddc5bb44ab@validator2.bes.dev2.aws.blockchaincloudpoc-develop.com:15043"
      
      - "enode://29f1b1822c67acbfcd49814b0a41c03f74c915108104e6df051b1c1e88abc7ef8335c80161e22bb43fce582af891527055dfd6fdfe0a9cb54f2a9e654093c8e7@validator3.bes.dev2.aws.blockchaincloudpoc-develop.com:15045"
      
      - "enode://d90928ad319b7eee34daf340905afc8ad418fda9db9b071774040b96d559093e15dbeedd2cc744df7848e320c6a8bc828544dacf1fee3ae21586c2bc2a145a0d@validator4.bes.dev2.aws.blockchaincloudpoc-develop.com:15047"
      
      - "enode://dff77de9ef3656ca693a1ae4e0d7600fd65e8aedf3010062289daee289fcf395380cf058a6b713d5a4aa886052a1ba20741c48349fb0dc2ad18ae43ef477db36@c-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15049"
      
      - "enode://ef387bb0d9dcc5d4b25d405cd692c564f337be841a93cb368716e7af210ebcadaf3d2b283fd260f32bb63b9400891660d101da7a7743abea705d040a1db545b7@m-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15061"
      
      - "enode://166fb2f3b6238cd145ebdb6669df96f73ecec75a0b1154c6eba0ea0105a82488a0078072aa1c5441b1d9c88360f2cd0b813e41b6843a6de927be6a9e7253c687@s-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15063"
      
      - "enode://cd1bf746fa63d9ffc822de9806dd49d48725c91b3a1f044bc8faa61de287b79899c7e921be0b44ad071f1804daf621738d9903608c0c33bd870cad5e51f26c9e@w-peer1.bes.dev2.aws.blockchaincloudpoc-develop.com:15065"
      

    metadata:
      namespace: supplychainkav-bes
      labels:

    ambassador:
      external_url_suffix: bes.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
 
    proxy:
      provider: ambassador
      external_url: supplychainkav.bes.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15041
      rpc: 15042

    images:
      node: hyperledger/besu:21.1.1
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator1
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://vault.internal.dev2.aws.blockchaincloudpoc-develop.com:20001
      secretprefix: secretsv2/data/supplychainkav-bes/crypto/validator1
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychainkav

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NDkyOGIxNmM1YTE5NjQ4ZWU0OWY1YjNhYzhmYTRkNTQ1OTRiYmY4Y2E5NDY3NWU1MmZiODQ4OTIxOGZjZGIyYjA1MWU4NmI1ODEwMmMzODA4OTk5NGE2MTg3ZDY5NWM5MDJkMDk5ZjIxNjllNjU3ZWQ4YzViNjUwNTBmOGE5NGY5ZmE5MTAwYmVhNDIzNmYzYjZiOGJiZTI0ZjU4YWRiNmEyODMzNTc4MDg0MDAwMDAwMDBjMCIKfQ==
